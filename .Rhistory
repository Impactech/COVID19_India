data_state <- d %>%
rename(state_ut = "State/UnionTerritory", sn = "Sno", Date = "Date") %>%
mutate(date = dmy(Date)) %>%
mutate(ConfirmedForeignNational = ifelse(is.na(ConfirmedForeignNational), 0, ConfirmedForeignNational)) %>%
###
group_by(state_ut, date) %>%
## Chosing the max number in case there are multiple entries for same date.
summarize(
ConfirmedIndianNational = max(ConfirmedIndianNational),
ConfirmedForeignNational = max(ConfirmedForeignNational),
Cured = max(Cured),
Deaths = max(Deaths)
) %>%
mutate(cumulative = ConfirmedIndianNational + ConfirmedForeignNational) %>%
filter(cumulative != 0) %>%
select(state_ut, date, cumulative) %>% ungroup()
data_total <- data_state %>% group_by(date) %>% summarize(cumulative = sum(cumulative)) %>%
mutate(state_ut = "India Total") %>% ungroup()
data <- rbind(data_state, data_total) %>%
mutate(day = as.integer(strftime(date, format = "%j")) ) %>%
###
group_by(state_ut) %>%
mutate( days_since_0 = day - min(day)  ) %>%
mutate( max_days = max(days_since_0) ) %>%
ungroup() %>%
###
filter(cumulative > 2) %>%
mutate(label =  paste(cumulative, state_ut, sep=" | "))
y_max <- max(data$cumulative)
x_max <- max(data$days_since_0)
x_label <- x_max + 5
labels <- data %>%
filter(date == yesterday) %>%
arrange( cumulative ) %>%
# mutate(yend = (y_max/n())*row_number()) %>%
mutate( yend = ( 2^(  (log2(y_max)/(n()) )*row_number()  )) ) %>%
select(state_ut, yend)
data <- left_join(data, labels, by = c("state_ut") )
View(data)
data <- rbind(data_state, data_total)
View(data)
source('./source_crowd_data.r')
dc <- build_crowd_data()
View(dc)
View(dc)
data <- dc %>%
select(StateUt, Date, Total)
mutate(Day = as.integer(strftime(Date, format = "%j")) ) %>%
###
group_by(StateUt) %>%
mutate( days_since_0 = day - min(day)  ) %>%
mutate( max_days = max(days_since_0) ) %>%
ungroup() %>%
###
filter(Total > 2) %>%
mutate(label =  paste(Total, StateUt, sep=" | "))
View(dc)
data <- dc %>%
select(StateUt, Date, Total) %>%
mutate(Day = as.integer(strftime(Date, format = "%j")) ) %>%
###
group_by(StateUt) %>%
mutate( days_since_0 = day - min(day)  ) %>%
mutate( max_days = max(days_since_0) ) %>%
ungroup() %>%
###
filter(Total > 2) %>%
mutate(label =  paste(Total, StateUt, sep=" | "))
data <- dc %>%
select(StateUt, Date, Total) %>%
mutate(Day = as.integer(strftime(Date, format = "%j")) ) %>%
###
group_by(StateUt) %>%
mutate( days_since_0 = day - min(day)  ) %>%
mutate( max_days = max(days_since_0) ) %>%
ungroup() %>%
###
filter(Total > 2)
data <- dc %>%
select(StateUt, Date, Total) %>%
mutate(Day = as.integer(strftime(Date, format = "%j")) ) %>%
###
group_by(StateUt) %>%
mutate( days_since_0 = day - min(day)  )
data <- dc %>%
select(StateUt, Date, Total) %>%
mutate(Day = as.integer(strftime(Date, format = "%j")) ) %>%
###
group_by(StateUt) %>%
mutate( DaysSince0 = Day - min(Day)  ) %>%
mutate( MaxDays = max(DaysSince0) ) %>%
ungroup() %>%
###
filter(Total > 2) %>%
mutate(label =  paste(Total, StateUt, sep=" | "))
View(data)
y_max <- max(data$Total)
x_max <- max(data$DaysSince0)
x_label <- x_max + 5
labels <- data %>%
filter(Date == yesterday) %>%
arrange( Total ) %>%
# mutate(yend = (y_max/n())*row_number()) %>%
mutate( yend = ( 2^(  (log2(y_max)/(n()) )*row_number()  )) ) %>%
select(StateUt, yend)
data <- left_join(data, labels, by = c("StateUt") )
View(data)
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
View(dc)
data_total <- dc %>% group_by(Date) %>% summarize(Total = sum(Total)) %>%
mutate(StateUt = "India Total") %>% ungroup()
View(data_total)
data_state <- dc %>%
select(StateUt, Date, Total)
View(data_state)
data <- rbind(data_total, data_state) %>%
mutate(Day = as.integer(strftime(Date, format = "%j")) ) %>%
###
group_by(StateUt) %>%
mutate( DaysSince0 = Day - min(Day)  ) %>%
mutate( MaxDays = max(DaysSince0) ) %>%
ungroup() %>%
###
filter(Total > 2) %>%
mutate(label =  paste(Total, StateUt, sep=" | "))
data <- rbind(data_total, data_state)
View(data)
data_total <- dc %>% group_by(Date) %>% summarize(Total = sum(Total)) %>%
mutate(StateUt = "India Total") %>% ungroup()
data_state <- dc %>% select(StateUt, Date, Total) %>% ungroup()
data <- rbind(data_total, data_state)
View(data)
data <- rbind(data_total, data_state) %>%
mutate(Day = as.integer(strftime(Date, format = "%j")) ) %>%
###
group_by(StateUt) %>%
mutate( DaysSince0 = Day - min(Day)  ) %>%
mutate( MaxDays = max(DaysSince0) ) %>%
ungroup() %>%
###
filter(Total > 2) %>%
mutate(label =  paste(Total, StateUt, sep=" | "))
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
Sys.Date()
?Sys.Date()
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
betterDates <- as.Date(Sys.Date(), format = "%B %d %Y")
betterDates
Sys.Date( format = "%B %d %Y")
Sys.Date("%B %d %Y")
format(Sys.Date(), "%B %d %Y")
source('~/work/covid19/COVID19_India/IndiaTimeseries_v2.R')
data_panindia <- dc %>% group_by(Date) %>% summarize(Total = sum(Total)) %>%
mutate(StateUt = "India Total") %>% ungroup()
data_states <- dc %>% select(StateUt, Date, Total) %>% ungroup()
data_statewise <- rbind(data_panindia, data_states) %>%
mutate(Day = as.integer(strftime(Date, format = "%j")) ) %>%
###
group_by(StateUt) %>%
mutate( DaysSince0 = Day - min(Day)  ) %>%
mutate( MaxDays = max(DaysSince0) ) %>%
ungroup() %>%
###
filter(Total > 2) %>%
mutate(label =  paste(Total, StateUt, sep=" | "))
# Calculating Data
y_max <- max(data_statewise$Total)
x_max <- max(data_statewise$DaysSince0)
x_label <- x_max + 5
labels <- data_statewise %>%
filter(Date == yesterday) %>%
arrange( Total ) %>%
# mutate(yend = (y_max/n())*row_number()) %>%
mutate( yend = ( 2^(  (log2(y_max)/(n()) )*row_number()  )) ) %>%
select(StateUt, yend)
data_statewise <- left_join(data_statewise, labels, by = c("StateUt") )
ggplot( data = data_statewise_latest,
aes(x=DaysSince0, y=Total, fill = StateUt, size = Total^(0.3) )
) +
geom_point(shape = 21, color = 'lightgrey') +
geom_line(size = 0.5, alpha=0.6)  +
geom_label(
aes(x=x_label, y = yend, label = label, fill=StateUt),
color='white', fontface = "bold",
hjust = 0, size=3) +
geom_segment(
aes(xend = x_label, yend = yend, color = StateUt),
linetype = "11", size=0.4, alpha=0.5) +
theme_minimal()
# Calculating Data
y_max <- max(data_statewise$Total)
x_max <- max(data_statewise$DaysSince0)
x_label <- x_max + 5
yesterday <- Sys.Date()
labels <- data_statewise %>%
filter(Date == yesterday) %>%
arrange( Total ) %>%
# mutate(yend = (y_max/n())*row_number()) %>%
mutate( yend = ( 2^(  (log2(y_max)/(n()) )*row_number()  )) ) %>%
select(StateUt, yend)
data_statewise <- left_join(data_statewise, labels, by = c("StateUt") )
data_statewise_latest <- data_statewise %>% filter(Date == yesterday)
ggplot( data = data_statewise_latest,
aes(x=DaysSince0, y=Total, fill = StateUt, size = Total^(0.3) )
) +
geom_point(shape = 21, color = 'lightgrey') +
geom_line(size = 0.5, alpha=0.6)  +
geom_label(
aes(x=x_label, y = yend, label = label, fill=StateUt),
color='white', fontface = "bold",
hjust = 0, size=3) +
geom_segment(
aes(xend = x_label, yend = yend, color = StateUt),
linetype = "11", size=0.4, alpha=0.5) +
theme_minimal()
View(data_statewise)
View(labels)
data_statewise <- left_join(data_statewise, labels, by = c("StateUt") )
View(data_statewise)
labels <- data_statewise %>%
filter(Date == yesterday) %>%
arrange( Total ) %>%
# mutate(yend = (y_max/n())*row_number()) %>%
mutate( yend = ( 2^(  (log2(y_max)/(n()) )*row_number()  )) ) %>%
select(StateUt, yend)
data_statewise <- left_join(data_statewise, labels, by = c("StateUt") )
View(data_statewise)
data_panindia <- dc %>% group_by(Date) %>% summarize(Total = sum(Total)) %>%
mutate(StateUt = "India Total") %>% ungroup()
data_states <- dc %>% select(StateUt, Date, Total) %>% ungroup()
data_statewise <- rbind(data_panindia, data_states) %>%
mutate(Day = as.integer(strftime(Date, format = "%j")) ) %>%
###
group_by(StateUt) %>%
mutate( DaysSince0 = Day - min(Day)  ) %>%
mutate( MaxDays = max(DaysSince0) ) %>%
ungroup() %>%
###
filter(Total > 2) %>%
mutate(label =  paste(Total, StateUt, sep=" | "))
View(data_statewise)
y_max <- max(data_statewise$Total)
x_max <- max(data_statewise$DaysSince0)
x_label <- x_max + 5
yesterday <- Sys.Date()
labels <- data_statewise %>%
filter(Date == yesterday) %>%
arrange( Total ) %>%
# mutate(yend = (y_max/n())*row_number()) %>%
mutate( yend = ( 2^(  (log2(y_max)/(n()) )*row_number()  )) ) %>%
select(StateUt, yend)
data_statewise <- left_join(data_statewise, labels, by = c("StateUt") )
View(data_statewise)
data_statewise_latest <- data_statewise %>% filter(Date == yesterday)
ggplot( data = data_statewise_latest,
aes(x=DaysSince0, y=Total, fill = StateUt, size = Total^(0.3) )
) +
geom_point(shape = 21, color = 'lightgrey') +
geom_line(size = 0.5, alpha=0.6)  +
geom_label(
aes(x=x_label, y = yend, label = label, fill=StateUt),
color='white', fontface = "bold",
hjust = 0, size=3) +
geom_segment(
aes(xend = x_label, yend = yend, color = StateUt),
linetype = "11", size=0.4, alpha=0.5) +
theme_minimal()
source('~/work/covid19/COVID19_India/IndiaCumulativeCases_v2.R')
source('~/work/covid19/COVID19_India/IndiaCumulativeCases_v2.R')
source('~/work/covid19/COVID19_India/IndiaCumulativeCases_v2.R')
source('~/work/covid19/COVID19_India/IndiaCumulativeCases_v2.R')
source('~/work/covid19/COVID19_India/IndiaCumulativeCases_v2.R')
source('~/work/covid19/COVID19_India/IndiaCumulativeCases_v2.R')
?geom_smooth
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=12, fig.height=8)
data_today <- data_abs %>%
filter(Date == Sys.Date()) %>%
pivot_wider(values_from = Cumulative, names_from = Source) %>%
select(-c(Date))
kable(data_today)
View(data_today)
data_today <- data_abs %>%
filter(Date == Sys.Date())
View(data_today)
data_today <- data_abs %>%
filter(Date == Sys.Date()) %>%
arrange(Status) %>%
select(-c(Date)) %>%
kable(data_today)
data_today <- data_abs %>%
filter(Date == Sys.Date()) %>%
arrange(Status) %>%
select(-c(Date)) %>%
View(data_today)
data_today <- data_abs
data_today <- data_abs %>%
filter(Date == Sys.Date())
View(data_today)
data_today <- data_abs %>%
filter(Date == Sys.Date()) %>%
arrange(Status)
View(data_today)
data_today <- data_abs %>%
filter(Date == Sys.Date()) %>%
arrange(Status) %>%
select(-c(Date))
kable(data_today)
data_today <- data_abs %>%
filter(Date == Sys.Date()) %>%
arrange(Status) %>%
select(-c(Date))
kable(data_today, caption = "Latest Data")
data_today <- data_abs %>%
filter(Date == Sys.Date()) %>%
arrange(Status) %>%
select(-c(Date))
kable(data_today, caption = "Latest Data") %>%
kable_styling(bootstrap_options = c("striped", "hover"))
data_today <- data_abs %>%
filter(Date == Sys.Date()) %>%
pivot_wider(values_from = Cumulative, names_from = Source) %>%
select(-c(Date)) %>%
kable(data_today) %>% kable_styling(bootstrap_options = c("striped", "hover"))
data_today <- data_abs %>%
filter(Date == Sys.Date()) %>%
pivot_wider(values_from = Cumulative, names_from = Source) %>%
select(-c(Date))
kable(data_today) %>% kable_styling(bootstrap_options = c("striped", "hover"))
data_today <- data_split_status %>%
filter(Date == Sys.Date()) %>%
pivot_wider(values_from = Cumulative, names_from = Source) %>%
select(-c(Date))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=10, fig.height=6)
data_today <- data_split_status %>%
filter(Date == Sys.Date()) %>%
pivot_wider(values_from = Cumulative, names_from = Source) %>%
select(-c(Date))
library(tidyverse)
library(lubridate)
library(viridis)
library(readr)
library(janitor)
library(kableExtra)
# library(plotly)
source('./source_crowd_data.r')
source('./source_official_data.r')
source('./source_crowd_data.r')
source('./source_official_data.r')
dc <- build_crowd_data()
do <- build_official_data()
d <- rbind(do, dc)
## Statewise Data
data_panindia <- dc %>% group_by(Date) %>% summarize(Total = sum(Total)) %>%
mutate(StateUt = "India Total") %>% ungroup()
data_states <- dc %>% select(StateUt, Date, Total) %>% ungroup()
data_statewise <- rbind(data_panindia, data_states) %>%
mutate(Day = as.integer(strftime(Date, format = "%j")) ) %>%
###
group_by(StateUt) %>%
mutate( DaysSince0 = Day - min(Day)  ) %>%
mutate( MaxDays = max(DaysSince0) ) %>%
ungroup() %>%
###
filter(Total > 2) %>%
mutate(label =  paste(Total, StateUt, sep=" | "))
data_total <- d %>%
pivot_longer(-c(StateUt, Date, Source), values_to = "Cumulative", names_to = "Status") %>%
group_by(Date, Source, Status) %>%
summarise(Cumulative = sum(Cumulative)) %>%
filter( Date > dmy('03-03-2020')) %>%
ungroup()
data_split_status <- data_total %>% filter(Status != 'Total')
data_today <- data_split_status %>%
filter(Date == Sys.Date()) %>%
pivot_wider(values_from = Cumulative, names_from = Source) %>%
select(-c(Date))
kable(data_today) %>% kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = "float_right") %>%
row_spec(2:4, bold = T, color = "white", background = "#D7261E")
data_today <- data_split_status %>%
filter(Date == Sys.Date()) %>%
pivot_wider(values_from = Cumulative, names_from = Source) %>%
select(-c(Date))
kable(data_today) %>% kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = "float_right") %>%
row_spec(1:3, bold = T, color = "white", background = "#D7261E")
data_today <- data_split_status %>%
filter(Date == Sys.Date()) %>%
pivot_wider(values_from = Cumulative, names_from = Source) %>%
select(-c(Date))
kable(data_today) %>% kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = "float_right") %>%
row_spec(1:3, bold = T, color = "white", background = "#d67b6b")
data_today <- data_split_status %>%
filter(Date == Sys.Date()) %>%
pivot_wider(values_from = Cumulative, names_from = Source) %>%
select(-c(Date))
kable(data_today) %>% kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = "float_right") %>%
row_spec(1:3, bold = T, color = "white", background = "#d67b6b")
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
View(data)
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
p <- ggplot(data = data, aes(x=Date, y=MaxDays, fill = StateUt, size = Total^(0.3) ))  +
geom_point(shape = 21, color = 'lightgrey') +
# geom_line(size = 0.5, alpha=0.6)  +
geom_label(
aes(x=x_label, y = yend, label = label, fill=StateUt),
color='white', fontface = "bold",
hjust = 0, size=3) +
geom_segment(aes(xend = x_label, yend = yend, color = StateUt), linetype = "11", size=0.4, alpha=0.5)
print(p)
p <- ggplot(data = data, aes(x=Date, y=MaxDays, fill = StateUt, size = Total^(0.3) ))  +
geom_point(shape = 21, color = 'lightgrey') +
# geom_line(size = 0.5, alpha=0.6)  +
geom_label(
aes(x=x_label, y = yend, label = label, fill=StateUt),
color='white', fontface = "bold",
hjust = 0, size=3) +
geom_segment(aes(xend = x_label, yend = yend, color = StateUt), linetype = "11", size=0.4, alpha=0.5)
print(p)
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
p <- ggplot(data = data, aes(x=Date, y=yend, fill = StateUt, size = Total^(0.3) ))  +
geom_point(shape = 21, color = 'lightgrey') +
# geom_line(size = 0.5, alpha=0.6)  +
geom_label(
aes(x=x_label, y = yend, label = label, fill=StateUt),
color='white', fontface = "bold",
hjust = 0, size=3) +
geom_segment(aes(xend = x_label, yend = yend, color = StateUt), linetype = "11", size=0.4, alpha=0.5)
p <- p + labs(
title = paste('Total number of cases on ', format(Sys.Date(), "%B %d %Y") ), fontface = "bold"
)
print(p)
View(data)
p <- ggplot(data = data, aes(x=Date, y=yend, fill = StateUt, size = Total^(0.3) ))  +
geom_point(shape = 21, color = 'lightgrey')
print(p)
p <- ggplot(data = data, aes(x=Date, y=yend, fill = StateUt, size = Total^(0.3) ))  +
geom_point(shape = 21, color = 'lightgrey') +
# geom_line(size = 0.5, alpha=0.6)  +
geom_label(
aes(x=yesterday+5, y = yend, label = label, fill=StateUt),
color='white', fontface = "bold",
hjust = 0, size=3) +
geom_segment(aes(xend = x_label, yend = yend, color = StateUt), linetype = "11", size=0.4, alpha=0.5)
p <- p +
theme_minimal() +
theme(
axis.text=element_text(size=10, color = "darkgrey"),
axis.title=element_text(size=12)
) +
theme( legend.position = 'off' ) +
theme(plot.title = element_text(size = 12, hjust = 0.5) ) +
theme(plot.margin = margin(15, 160, 15, 10)) +
coord_cartesian(clip = 'off')  +
scale_color_viridis_d(option="inferno", end = 0.9) +
scale_fill_viridis_d(option="inferno", end = 0.9) +
xlab("Number of day since first report") +
ylab("Number of cases (Cumulative)")  +
# scale_y_continuous(trans = 'log2') + scale_radius(
#   range = c(1, 15),
#   trans = "identity",
#   guide = "legend"
# )
p <- p + labs(
title = paste('Total number of cases on ', format(Sys.Date(), "%B %d %Y") ), fontface = "bold"
)
print(p)
p <- ggplot(data = data, aes(x=Date, y=yend, fill = StateUt, size = Total^(0.3) ))  +
geom_point(shape = 21, color = 'lightgrey') +
# geom_line(size = 0.5, alpha=0.6)  +
geom_label(
aes(x=yesterday+5, y = yend, label = label, fill=StateUt),
color='white', fontface = "bold",
hjust = 0, size=3) +
geom_segment(aes(xend = x_label, yend = yend, color = StateUt), linetype = "11", size=0.4, alpha=0.5)
print(p)
p <- ggplot(data = data, aes(x=Date, y=yend, fill = StateUt, size = Total^(0.3) ))  +
geom_point(shape = 21, color = 'lightgrey')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
source('~/work/covid19/COVID19_India/IndiaTimeseries_v3.R')
